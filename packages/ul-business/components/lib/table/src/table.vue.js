"use strict";Object.defineProperties(exports,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}});const e=require("vue"),U=require("./type.js"),C=require("@iconify/vue"),b=require("lodash"),I={class:"ul-table"},L={key:0,class:"ul-table__search"},O={class:"ul-table__content"},j={class:"table-head"},A={class:"operate-box"},M={class:"dialog-footer"},R=e.defineComponent({name:"UlTable"}),W=e.defineComponent({...R,props:U.tableProps,setup(k){const l=k;e.useCssVars(t=>({"2baa258c":t.pagingAlign}));const _=e.ref(),y=e.ref(!1),h=e.ref([]),g=e.ref(0),p=e.reactive({[l.pageKey]:1,[l.sizeKey]:10}),d=async()=>{var t,o;if(l.getList){const a=(o=(t=_.value)==null?void 0:t.getValue)==null?void 0:o.call(t),r=await l.getList({...p,...a}),c=l.dataPath||"data",s=l.totalPath||"total";h.value=b.get(r,c),g.value=b.get(r,s)}};l.immediate&&d();const N=()=>{var t,o,a;(a=(o=(t=_.value)==null?void 0:t.elFrom)==null?void 0:o.resetFields)==null||a.call(o),d()},w=t=>{p[l.sizeKey]=t,d()},x=t=>{p[l.pageKey]=t,d()},n=e.reactive({visible:!1,title:"",disabled:!1,saveType:""}),m=e.ref(),B=()=>{var t,o,a;(a=(o=(t=m.value)==null?void 0:t.elFrom)==null?void 0:o.resetFields)==null||a.call(o)},T=()=>{if(l.onNew){l.onNew();return}n.title="新增",n.visible=!0,n.disabled=!1,n.saveType="new"},V=async t=>{let o=t;l.getDetail&&(o=await l.getDetail(t)),e.nextTick(()=>{var a,r;(r=(a=m.value)==null?void 0:a.setValue)==null||r.call(a,o)})},F=async t=>{l.deleteSumbit&&l.deleteSumbit(t)},S=async t=>{if(l.onEdit){l.onEdit(t);return}n.title="编辑",n.visible=!0,n.disabled=!1,n.saveType="edit",V(t)},P=async t=>{if(l.onView){l.onView(t);return}n.title="查看",n.visible=!0,n.disabled=!0,V(t)},D=async()=>{var t,o,a;(a=(o=(t=m.value)==null?void 0:t.elFrom)==null?void 0:o.validate)==null||a.call(o,async r=>{var s,u;if(!r)return;let c=l.newSumbit;if(n.saveType==="edit"&&(c=l.editSumbit),c){const v=(u=(s=m.value)==null?void 0:s.getValue)==null?void 0:u.call(s);await c(v),n.visible=!1,d()}})};return(t,o)=>{const a=e.resolveComponent("el-icon"),r=e.resolveComponent("el-button"),c=e.resolveComponent("el-form-item"),s=e.resolveComponent("ul-form"),u=e.resolveComponent("el-table-column"),v=e.resolveComponent("el-popconfirm"),E=e.resolveComponent("el-table"),z=e.resolveComponent("el-pagination"),$=e.resolveComponent("el-dialog"),K=e.resolveDirective("loading");return e.openBlock(),e.createElementBlock("div",I,[t.searchForms.length>0?(e.openBlock(),e.createElementBlock("div",L,[e.createVNode(s,{ref_key:"searchForm",ref:_,content:t.searchForms,inline:""},{last:e.withCtx(()=>[e.createVNode(c,null,{default:e.withCtx(()=>[e.createVNode(r,{type:"primary",onClick:d},{icon:e.withCtx(()=>[e.createVNode(a,null,{default:e.withCtx(()=>[e.createVNode(e.unref(C.Icon),{icon:"ep:search"})]),_:1})]),default:e.withCtx(()=>[e.createTextVNode(" 查询 ")]),_:1}),e.createVNode(r,{onClick:N},{icon:e.withCtx(()=>[e.createVNode(a,null,{default:e.withCtx(()=>[e.createVNode(e.unref(C.Icon),{icon:"ep:refresh"})]),_:1})]),default:e.withCtx(()=>[e.createTextVNode(" 重置 ")]),_:1})]),_:1})]),_:1},8,["content"])])):e.createCommentVNode("",!0),e.createElementVNode("div",O,[e.createElementVNode("div",j,[e.createVNode(r,{type:"primary",onClick:T},{icon:e.withCtx(()=>[e.createVNode(a,null,{default:e.withCtx(()=>[e.createVNode(e.unref(C.Icon),{icon:"ep:plus"})]),_:1})]),default:e.withCtx(()=>[e.createTextVNode(" 新增 ")]),_:1})]),e.withDirectives((e.openBlock(),e.createBlock(E,e.mergeProps({border:"",data:h.value,"element-loading-text":"正在努力加载..."},t.$attrs),{default:e.withCtx(()=>[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(t.columns,i=>(e.openBlock(),e.createElementBlock(e.Fragment,null,[i.component?(e.openBlock(),e.createBlock(u,{key:0,label:i.label},{default:e.withCtx(({row:f})=>[(e.openBlock(),e.createBlock(e.resolveDynamicComponent(i.component),e.mergeProps({modelValue:f[i.prop],"onUpdate:modelValue":q=>f[i.prop]=q},i.el),null,16,["modelValue","onUpdate:modelValue"]))]),_:2},1032,["label"])):(e.openBlock(),e.createBlock(u,e.normalizeProps(e.mergeProps({key:1},i)),null,16))],64))),256)),t.hasOperateColumn&&t.columns.length>0?(e.openBlock(),e.createBlock(u,{key:0,label:"操作",align:"center",width:t.opWidth,fixed:"right"},{default:e.withCtx(({row:i})=>[e.createElementVNode("div",A,[e.createVNode(r,{link:"",type:"primary",onClick:f=>P(i)},{default:e.withCtx(()=>[e.createTextVNode("查看")]),_:2},1032,["onClick"]),e.createVNode(r,{link:"",type:"primary",onClick:f=>S(i)},{default:e.withCtx(()=>[e.createTextVNode("编辑")]),_:2},1032,["onClick"]),e.createVNode(v,{title:"确定要删除该数据吗?","confirm-button-type":"danger","confirm-button-text":"删除",onClick:F},{reference:e.withCtx(()=>[e.createVNode(r,{link:"",type:"danger"},{default:e.withCtx(()=>[e.createTextVNode("删除")]),_:1})]),_:1}),e.renderSlot(t.$slots,"extraOp")])]),_:3},8,["width"])):e.createCommentVNode("",!0)]),_:3},16,["data"])),[[K,y.value]]),t.hasPagination&&g.value>0?(e.openBlock(),e.createBlock(z,e.mergeProps({key:0,class:"paging-box",layout:"total, sizes, prev, pager, next, jumper",background:"",small:""},t.pagingAttr,{"current-page":p[l.pageKey],"page-size":p[l.sizeKey],total:g.value,onSizeChange:w,onCurrentChange:x}),null,16,["current-page","page-size","total"])):e.createCommentVNode("",!0)]),e.createVNode($,{modelValue:n.visible,"onUpdate:modelValue":o[2]||(o[2]=i=>n.visible=i),title:n.title,onClose:B},e.createSlots({default:e.withCtx(()=>[e.createVNode(s,{ref_key:"dialogForm",ref:m,disabled:n.disabled,content:t.forms},null,8,["disabled","content"])]),_:2},[n.disabled?void 0:{name:"footer",fn:e.withCtx(()=>[e.createElementVNode("span",M,[e.createVNode(r,{onClick:o[0]||(o[0]=i=>n.visible=!1)},{default:e.withCtx(()=>[e.createTextVNode("取消")]),_:1}),e.createVNode(r,{type:"primary",onClick:o[1]||(o[1]=i=>D())},{default:e.withCtx(()=>[e.createTextVNode(" 保存 ")]),_:1})])]),key:"0"}]),1032,["modelValue","title"])])}}});exports.default=W;
