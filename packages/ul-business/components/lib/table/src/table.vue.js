"use strict";Object.defineProperties(exports,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}});const d=require("element-plus/es");require("element-plus/es/components/base/style/css");require("element-plus/es/components/loading/style/css");require("element-plus/es/components/dialog/style/css");require("element-plus/es/components/pagination/style/css");require("element-plus/es/components/table/style/css");require("element-plus/es/components/popconfirm/style/css");require("element-plus/es/components/table-column/style/css");require("element-plus/es/components/form-item/style/css");require("element-plus/es/components/button/style/css");require("element-plus/es/components/icon/style/css");const e=require("vue"),U=require("./type.js"),C=require("@iconify/vue"),N=require("lodash"),O={class:"ul-table"},j={key:0,class:"ul-table__search"},A={class:"ul-table__content"},M={class:"table-head"},R={key:1},W={key:1},G={class:"operate-box"},H={class:"dialog-footer"},J=e.defineComponent({name:"UlTable",__name:"table",props:U.tableProps,setup(w){const l=w;e.useCssVars(t=>({"67d2737d":t.pagingAlign}));const _=e.ref(),x=e.ref(!1),v=e.ref([]),h=e.ref(0),m=e.reactive({[l.pageKey]:1,[l.sizeKey]:10}),y=t=>{const{label:o,component:a,el:i,...c}=t;return c},u=async()=>{var t,o;if(l.getList){const a=(o=(t=_.value)==null?void 0:t.getValue)==null?void 0:o.call(t),i=await l.getList({...m,...a}),c=l.dataPath||"data",s=l.totalPath||"total";v.value=N.get(i,c),h.value=N.get(i,s)}};l.immediate&&u();const B=()=>{var t,o,a;(a=(o=(t=_.value)==null?void 0:t.elFrom)==null?void 0:o.resetFields)==null||a.call(o),u()},E=t=>{m[l.sizeKey]=t,u()},P=t=>{m[l.pageKey]=t,u()},r=e.reactive({visible:!1,title:"",disabled:!1,saveType:""}),f=e.ref(),T=()=>{var t,o,a;(a=(o=(t=f.value)==null?void 0:t.elFrom)==null?void 0:o.resetFields)==null||a.call(o)},D=()=>{if(l.onNew){l.onNew();return}r.title="新增",r.visible=!0,r.disabled=!1,r.saveType="new"},b=async t=>{let o=t;l.getDetail&&(o=await l.getDetail(t)),e.nextTick(()=>{var a,i;(i=(a=f.value)==null?void 0:a.setValue)==null||i.call(a,o)})},S=async t=>{l.deleteSumbit&&l.deleteSumbit(t)},q=async t=>{if(l.onEdit){l.onEdit(t);return}r.title="编辑",r.visible=!0,r.disabled=!1,r.saveType="edit",b(t)},F=async t=>{if(l.onView){l.onView(t);return}r.title="查看",r.visible=!0,r.disabled=!0,b(t)},z=async()=>{var t,o,a;(a=(o=(t=f.value)==null?void 0:t.elFrom)==null?void 0:o.validate)==null||a.call(o,async i=>{var s,p;if(!i)return;let c=l.newSumbit;if(r.saveType==="edit"&&(c=l.editSumbit),c){const k=(p=(s=f.value)==null?void 0:s.getValue)==null?void 0:p.call(s);await c(k)!==!1&&(r.visible=!1,u())}})};return(t,o)=>{const a=d.ElIcon,i=d.ElButton,c=d.ElFormItem,s=e.resolveComponent("ul-form"),p=d.ElTableColumn,k=d.ElPopconfirm,V=d.ElTable,$=d.ElPagination,K=d.ElDialog,I=d.ElLoadingDirective;return e.openBlock(),e.createElementBlock("div",O,[t.searchForms.length>0?(e.openBlock(),e.createElementBlock("div",j,[e.createVNode(s,{ref_key:"searchForm",ref:_,content:t.searchForms,inline:""},{final:e.withCtx(()=>[e.createVNode(c,null,{default:e.withCtx(()=>[e.createVNode(i,{type:"primary",onClick:u},{icon:e.withCtx(()=>[e.createVNode(a,null,{default:e.withCtx(()=>[e.createVNode(e.unref(C.Icon),{icon:"ep:search"})]),_:1})]),default:e.withCtx(()=>[e.createTextVNode(" 查询 ")]),_:1}),e.createVNode(i,{onClick:B},{icon:e.withCtx(()=>[e.createVNode(a,null,{default:e.withCtx(()=>[e.createVNode(e.unref(C.Icon),{icon:"ep:refresh"})]),_:1})]),default:e.withCtx(()=>[e.createTextVNode(" 重置 ")]),_:1})]),_:1})]),_:1},8,["content"])])):e.createCommentVNode("",!0),e.createElementVNode("div",A,[e.createElementVNode("div",M,[e.createVNode(i,{type:"primary",onClick:D},{icon:e.withCtx(()=>[e.createVNode(a,null,{default:e.withCtx(()=>[e.createVNode(e.unref(C.Icon),{icon:"ep:plus"})]),_:1})]),default:e.withCtx(()=>[e.createTextVNode(" 新增 ")]),_:1}),e.renderSlot(t.$slots,"head")]),e.withDirectives((e.openBlock(),e.createBlock(V,e.mergeProps({border:"",data:v.value,"element-loading-text":"正在努力加载..."},t.$attrs),{default:e.withCtx(()=>[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(t.columns,n=>(e.openBlock(),e.createElementBlock(e.Fragment,null,[n.component?(e.openBlock(),e.createBlock(p,e.normalizeProps(e.mergeProps({key:0},y(n))),{header:e.withCtx(()=>[n.label&&typeof n.label=="function"?(e.openBlock(),e.createBlock(e.resolveDynamicComponent(n.label()),{key:0})):(e.openBlock(),e.createElementBlock("span",R,e.toDisplayString(n.label),1))]),default:e.withCtx(({row:g})=>[(e.openBlock(),e.createBlock(e.resolveDynamicComponent(n.component),e.mergeProps({modelValue:g[n.prop],"onUpdate:modelValue":L=>g[n.prop]=L},n.el),null,16,["modelValue","onUpdate:modelValue"]))]),_:2},1040)):(e.openBlock(),e.createBlock(p,e.normalizeProps(e.mergeProps({key:1},y(n))),{header:e.withCtx(()=>[n.label&&typeof n.label=="function"?(e.openBlock(),e.createBlock(e.resolveDynamicComponent(n.label()),{key:0})):(e.openBlock(),e.createElementBlock("span",W,e.toDisplayString(n.label),1))]),_:2},1040))],64))),256)),t.hasOperateColumn&&t.columns.length>0?(e.openBlock(),e.createBlock(p,{key:0,label:"操作",align:"center",width:t.opWidth,fixed:"right"},{default:e.withCtx(({row:n})=>[e.createElementVNode("div",G,[e.createVNode(i,{link:"",type:"primary",onClick:g=>F(n)},{default:e.withCtx(()=>[e.createTextVNode("查看")]),_:2},1032,["onClick"]),e.createVNode(i,{link:"",type:"primary",onClick:g=>q(n)},{default:e.withCtx(()=>[e.createTextVNode("编辑")]),_:2},1032,["onClick"]),e.createVNode(k,{title:"确定要删除该数据吗?","confirm-button-type":"danger","confirm-button-text":"删除",onClick:S},{reference:e.withCtx(()=>[e.createVNode(i,{link:"",type:"danger"},{default:e.withCtx(()=>[e.createTextVNode("删除")]),_:1})]),_:1}),e.renderSlot(t.$slots,"extraOp")])]),_:3},8,["width"])):e.createCommentVNode("",!0)]),_:3},16,["data"])),[[I,x.value]]),t.hasPagination&&h.value>0?(e.openBlock(),e.createBlock($,e.mergeProps({key:0,class:"paging-box",layout:"total, sizes, prev, pager, next, jumper",background:"",small:""},t.pagingAttr,{"current-page":m[l.pageKey],"page-size":m[l.sizeKey],total:h.value,onSizeChange:E,onCurrentChange:P}),null,16,["current-page","page-size","total"])):e.createCommentVNode("",!0)]),e.createVNode(K,{modelValue:r.visible,"onUpdate:modelValue":o[2]||(o[2]=n=>r.visible=n),title:r.title,onClose:T},e.createSlots({default:e.withCtx(()=>[e.createVNode(s,{ref_key:"dialogForm",ref:f,disabled:r.disabled,content:t.forms},null,8,["disabled","content"])]),_:2},[r.disabled?void 0:{name:"footer",fn:e.withCtx(()=>[e.createElementVNode("span",H,[e.createVNode(i,{onClick:o[0]||(o[0]=n=>r.visible=!1)},{default:e.withCtx(()=>[e.createTextVNode("取消")]),_:1}),e.createVNode(i,{type:"primary",onClick:o[1]||(o[1]=n=>z())},{default:e.withCtx(()=>[e.createTextVNode(" 保存 ")]),_:1})])]),key:"0"}]),1032,["modelValue","title"])])}}});exports.default=J;
