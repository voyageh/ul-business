"use strict";Object.defineProperties(exports,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}});const d=require("element-plus/es");require("element-plus/es/components/base/style/css");require("element-plus/es/components/loading/style/css");require("element-plus/es/components/dialog/style/css");require("element-plus/es/components/pagination/style/css");require("element-plus/es/components/table/style/css");require("element-plus/es/components/popconfirm/style/css");require("element-plus/es/components/table-column/style/css");require("element-plus/es/components/form-item/style/css");require("element-plus/es/components/button/style/css");require("element-plus/es/components/icon/style/css");const e=require("vue"),j=require("./type.js"),b=require("@iconify/vue"),N=require("lodash"),A=require("element-plus/es/components/table/src/table/defaults"),M={class:"ul-table"},R={key:0,class:"ul-table__search"},W={class:"ul-table__content"},G={class:"table-head"},H={key:1},J={key:1},Q={key:1},X={class:"operate-box"},Y={class:"dialog-footer"},Z=e.defineComponent({name:"UlTable",__name:"table",props:j.tableProps,setup(x){const a=x;e.useCssVars(t=>({"6dea391e":t.pagingAlign}));const _=e.ref(),w=e.ref(!1),V=e.ref([]),y=e.ref(0),f=e.reactive({[a.pageKey]:1,[a.sizeKey]:10}),E=t=>{const o={};return Object.keys(A).forEach(n=>{t[n]&&(o[n]=t[n])}),o},C=t=>{const{label:o,component:n,el:i,children:u,...s}=t;return s},m=async()=>{var t,o;if(a.getList){const n=(o=(t=_.value)==null?void 0:t.getValue)==null?void 0:o.call(t),i=await a.getList({...f,...n}),u=a.dataPath||"data",s=a.totalPath||"total";V.value=N.get(i,u),y.value=N.get(i,s)}};a.immediate&&m();const D=()=>{var t,o,n;(n=(o=(t=_.value)==null?void 0:t.elFrom)==null?void 0:o.resetFields)==null||n.call(o),m()},P=t=>{f[a.sizeKey]=t,m()},T=t=>{f[a.pageKey]=t,m()},r=e.reactive({visible:!1,title:"",disabled:!1,saveType:""}),k=e.ref(),S=()=>{var t,o,n;(n=(o=(t=k.value)==null?void 0:t.elFrom)==null?void 0:o.resetFields)==null||n.call(o)},F=()=>{if(a.onNew){a.onNew();return}r.title="新增",r.visible=!0,r.disabled=!1,r.saveType="new"},v=async t=>{let o=t;a.getDetail&&(o=await a.getDetail(t)),e.nextTick(()=>{var n,i;(i=(n=k.value)==null?void 0:n.setValue)==null||i.call(n,o)})},q=async t=>{a.deleteSumbit&&a.deleteSumbit(t)},z=async t=>{if(a.onEdit){a.onEdit(t);return}r.title="编辑",r.visible=!0,r.disabled=!1,r.saveType="edit",v(t)},$=async t=>{if(a.onView){a.onView(t);return}r.title="查看",r.visible=!0,r.disabled=!0,v(t)},K=async()=>{var t,o,n;(n=(o=(t=k.value)==null?void 0:t.elFrom)==null?void 0:o.validate)==null||n.call(o,async i=>{var s,p;if(!i)return;let u=a.newSumbit;if(r.saveType==="edit"&&(u=a.editSumbit),u){const h=(p=(s=k.value)==null?void 0:s.getValue)==null?void 0:p.call(s);await u(h)!==!1&&(r.visible=!1,m())}})};return(t,o)=>{const n=d.ElIcon,i=d.ElButton,u=d.ElFormItem,s=e.resolveComponent("ul-form"),p=d.ElTableColumn,h=d.ElPopconfirm,B=d.ElTable,U=d.ElPagination,I=d.ElDialog,L=d.ElLoadingDirective;return e.openBlock(),e.createElementBlock("div",M,[t.searchForms.length>0?(e.openBlock(),e.createElementBlock("div",R,[e.createVNode(s,{ref_key:"searchForm",ref:_,content:t.searchForms,inline:""},{final:e.withCtx(()=>[e.createVNode(u,null,{default:e.withCtx(()=>[e.createVNode(i,{type:"primary",onClick:m},{icon:e.withCtx(()=>[e.createVNode(n,null,{default:e.withCtx(()=>[e.createVNode(e.unref(b.Icon),{icon:"ep:search"})]),_:1})]),default:e.withCtx(()=>[e.createTextVNode(" 查询 ")]),_:1}),e.createVNode(i,{onClick:D},{icon:e.withCtx(()=>[e.createVNode(n,null,{default:e.withCtx(()=>[e.createVNode(e.unref(b.Icon),{icon:"ep:refresh"})]),_:1})]),default:e.withCtx(()=>[e.createTextVNode(" 重置 ")]),_:1})]),_:1})]),_:1},8,["content"])])):e.createCommentVNode("",!0),e.createElementVNode("div",W,[e.createElementVNode("div",G,[e.createVNode(i,{type:"primary",onClick:F},{icon:e.withCtx(()=>[e.createVNode(n,null,{default:e.withCtx(()=>[e.createVNode(e.unref(b.Icon),{icon:"ep:plus"})]),_:1})]),default:e.withCtx(()=>[e.createTextVNode(" 新增 ")]),_:1}),e.renderSlot(t.$slots,"head")]),e.withDirectives((e.openBlock(),e.createBlock(B,e.mergeProps({border:""},E(t.$props),{data:V.value,"element-loading-text":"正在努力加载..."}),{default:e.withCtx(()=>[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(t.columns,l=>(e.openBlock(),e.createElementBlock(e.Fragment,null,[l.children?(e.openBlock(),e.createBlock(p,e.normalizeProps(e.mergeProps({key:0},C(l))),{header:e.withCtx(()=>[l.label&&typeof l.label=="function"?(e.openBlock(),e.createBlock(e.resolveDynamicComponent(l.label()),{key:0})):(e.openBlock(),e.createElementBlock("span",H,e.toDisplayString(l.label),1))]),default:e.withCtx(()=>[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(l.children,c=>(e.openBlock(),e.createBlock(p,e.mergeProps({key:c.prop},C(c)),{header:e.withCtx(()=>[c.label&&typeof c.label=="function"?(e.openBlock(),e.createBlock(e.resolveDynamicComponent(c.label()),{key:0})):(e.openBlock(),e.createElementBlock("span",J,e.toDisplayString(c.label),1))]),default:e.withCtx(({row:g})=>[c.component?(e.openBlock(),e.createBlock(e.resolveDynamicComponent(c.component),e.mergeProps({key:0,modelValue:g[c.prop],"onUpdate:modelValue":O=>g[c.prop]=O},c.el),null,16,["modelValue","onUpdate:modelValue"])):(e.openBlock(),e.createElementBlock(e.Fragment,{key:1},[e.createTextVNode(e.toDisplayString(g[c.prop]),1)],64))]),_:2},1040))),128))]),_:2},1040)):(e.openBlock(),e.createBlock(p,e.normalizeProps(e.mergeProps({key:1},C(l))),{header:e.withCtx(()=>[l.label&&typeof l.label=="function"?(e.openBlock(),e.createBlock(e.resolveDynamicComponent(l.label()),{key:0})):(e.openBlock(),e.createElementBlock("span",Q,e.toDisplayString(l.label),1))]),default:e.withCtx(({row:c})=>[l.component?(e.openBlock(),e.createBlock(e.resolveDynamicComponent(l.component),e.mergeProps({key:0,modelValue:c[l.prop],"onUpdate:modelValue":g=>c[l.prop]=g},l.el),null,16,["modelValue","onUpdate:modelValue"])):(e.openBlock(),e.createElementBlock(e.Fragment,{key:1},[e.createTextVNode(e.toDisplayString(c[l.prop]),1)],64))]),_:2},1040))],64))),256)),t.hasOperateColumn&&t.columns.length>0?(e.openBlock(),e.createBlock(p,{key:0,label:"操作",align:"center",width:t.opWidth,fixed:"right"},{default:e.withCtx(({row:l})=>[e.createElementVNode("div",X,[e.createVNode(i,{link:"",type:"primary",onClick:c=>$(l)},{default:e.withCtx(()=>[e.createTextVNode("查看")]),_:2},1032,["onClick"]),e.createVNode(i,{link:"",type:"primary",onClick:c=>z(l)},{default:e.withCtx(()=>[e.createTextVNode("编辑")]),_:2},1032,["onClick"]),e.createVNode(h,{title:"确定要删除该数据吗?","confirm-button-type":"danger","confirm-button-text":"删除",onClick:q},{reference:e.withCtx(()=>[e.createVNode(i,{link:"",type:"danger"},{default:e.withCtx(()=>[e.createTextVNode("删除")]),_:1})]),_:1}),e.renderSlot(t.$slots,"extraOp")])]),_:3},8,["width"])):e.createCommentVNode("",!0)]),_:3},16,["data"])),[[L,w.value]]),t.hasPagination&&y.value>0?(e.openBlock(),e.createBlock(U,e.mergeProps({key:0,class:"paging-box",layout:"total, sizes, prev, pager, next, jumper",background:"",small:""},t.pagingAttr,{"current-page":f[a.pageKey],"page-size":f[a.sizeKey],total:y.value,onSizeChange:P,onCurrentChange:T}),null,16,["current-page","page-size","total"])):e.createCommentVNode("",!0)]),e.createVNode(I,{modelValue:r.visible,"onUpdate:modelValue":o[2]||(o[2]=l=>r.visible=l),title:r.title,onClose:S},e.createSlots({default:e.withCtx(()=>[e.createVNode(s,{ref_key:"dialogForm",ref:k,disabled:r.disabled,content:t.forms},null,8,["disabled","content"])]),_:2},[r.disabled?void 0:{name:"footer",fn:e.withCtx(()=>[e.createElementVNode("span",Y,[e.createVNode(i,{onClick:o[0]||(o[0]=l=>r.visible=!1)},{default:e.withCtx(()=>[e.createTextVNode("取消")]),_:1}),e.createVNode(i,{type:"primary",onClick:o[1]||(o[1]=l=>K())},{default:e.withCtx(()=>[e.createTextVNode(" 保存 ")]),_:1})])]),key:"0"}]),1032,["modelValue","title"])])}}});exports.default=Z;
